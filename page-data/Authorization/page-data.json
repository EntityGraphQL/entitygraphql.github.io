{"componentChunkName":"component---src-templates-docs-js","path":"/authorization","result":{"data":{"site":{"siteMetadata":{"title":"Entity GraphQL Docs","docsLocation":"https://github.com/lukemurray/EntityGraphQL/tree/master/docs/content"}},"mdx":{"fields":{"id":"04a28633-b666-5a16-aec8-abe520ec6ff5","title":"Authorization","slug":"/authorization"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Authorization\",\n  \"metaTitle\": \"Adding authorization to your schema - EntityGraphQL\",\n  \"metaDescription\": \"Adding authorization to your GraphQL schema\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"You should secure the route where you app/client posts request to in any ASP.NET supports. Given GraphQL works with a schema you likely want to provide security within the schema. EntityGraphQL provides support for checking claims on a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ClaimsIdentity\"), \" object.\"), mdx(\"p\", null, \"First pass in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ClaimsIdentity\"), \" to the query call\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"// Assuming you're in a ASP.NET controller\\nvar results = _schemaProvider.ExecuteQuery(query, _dbContext, HttpContext.RequestServices, this.User.Identities.FirstOrDefault());\\n\")), mdx(\"p\", null, \"Now if a field or mutation has \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AuthorizeClaims\"), \" it will check if the supplied \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ClaimsIdentity\"), \" contains any of those claims using the claim type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ClaimTypes.Role\"), \".\"), mdx(\"p\", null, \"_Note: if you provide multiple \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[GraphQLAuthorize]\"), \" attributes on a single field/mutation they are treated as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AND\"), \" meaning all claims are required. If you provide a single \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[GraphQLAuthorize]\"), \" attribute with multiple claims in it they are treated as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OR\"), \" i.e. having any of the claims listed will grant access.\"), mdx(\"h1\", null, \"Mutations\"), mdx(\"p\", null, \"Mark you mutation methods with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[GraphQLAuthorize(\\\"claim-name\\\")]\"), \" attribute.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"public class MovieMutations\\n{\\n  [GraphQLMutation]\\n  [GraphQLAuthorize(\\\"movie-editor\\\")]\\n  public Movie AddActor(MyDbContext db, ActorArgs args)\\n  {\\n    // ...\\n  }\\n}\\n\")), mdx(\"p\", null, \"If a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ClaimsIdentity\"), \" is provided with the query call it will be required to be Authorized and have a claim of type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Role\"), \" with a value of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"movie-editor\"), \" to call this mutation.\"), mdx(\"h1\", null, \"Queries\"), mdx(\"p\", null, \"If you are using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SchemaBuilder.FromObject<TContext>()\"), \" you can use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[GraphQLAuthorize(\\\"claim-name\\\")]\"), \" attribute again throughout the objects.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"public class MyDbContext : DbContext {\\n  protected override void OnModelCreating(ModelBuilder builder) {\\n    // Set up your relations\\n  }\\n\\n  // require either claim\\n  [GraphQLAuthorize(\\\"property-role\\\", \\\"admin-property-role\\\")]\\n  public DbSet<Property> Properties { get; set; }\\n  public DbSet<PropertyType> PropertyTypes { get; set; }\\n  public DbSet<Location> Locations { get; set; }\\n}\\n\\npublic class Property {\\n  public uint Id { get; set; }\\n  public string Name { get; set; }\\n  public PropertyType Type { get; set; }\\n  // require both claims\\n  [GraphQLAuthorize(\\\"property-admin\\\")]\\n  [GraphQLAuthorize(\\\"super-admin\\\")]\\n  public Location Location { get; set; }\\n}\\n\\n// ....\\n\")), mdx(\"p\", null, \"You can secure whole types with the attribute too.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"[GraphQLAuthorize(\\\"property-user\\\")]\\npublic class Property {\\n  public uint Id { get; set; }\\n  public string Name { get; set; }\\n  public PropertyType Type { get; set; }\\n  public Location Location { get; set; }\\n}\\n\")), mdx(\"p\", null, \"If a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ClaimsIdentity\"), \" is provided with the query call it will be required to be Authorized and have a claim of type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Role\"), \" with a value of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"property-role\"), \" to query the root-level \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"properties\"), \" field and a claim of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"property-admin\"), \" to query the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Property\"), \" field \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"location\"), \".\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AuthorizeClaims\"), \" can be provided in the API for add/replacing fields on the schema objact.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"schemaProvider.AddField(\\\"myField\\\", (db) => db.MyEntities, \\\"Description\\\").RequiresAllClaims(\\\"admin\\\");\\nschemaProvider.AddField(\\\"myField\\\", (db) => db.MyEntities, \\\"Description\\\").RequiresAnyClaim(\\\"admin\\\", \\\"super-admin\\\");\\n\\nschemaProvider.AddType<Property>(\\\"properties\\\", (db) => db.Properties, \\\"Description\\\").RequiresAllClaims(\\\"property-user\\\");\\nschemaProvider.AddType<Property>(\\\"properties\\\", (db) => db.Properties, \\\"Description\\\").RequiresAnyClaims(\\\"property-user\\\", \\\"property-admin\\\");\\n\")), mdx(\"p\", null, \"Note when using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AddField()\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AddType()\"), \" these functions will automatically search for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[GraphQLAuthorize()]\"), \" attributes on the fields and types.\"));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#mutations","title":"Mutations"},{"url":"#queries","title":"Queries"}]},"parent":{"relativePath":"authorization.md"},"frontmatter":{"metaTitle":"Adding authorization to your schema - EntityGraphQL","metaDescription":"Adding authorization to your GraphQL schema"}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/authorization","title":"Authorization"}}},{"node":{"fields":{"slug":"/","title":"Entity GraphQL"}}},{"node":{"fields":{"slug":"/entity-framework","title":"Entity Framework"}}},{"node":{"fields":{"slug":"/getting-started","title":"Getting Started"}}},{"node":{"fields":{"slug":"/integration","title":"Integration"}}},{"node":{"fields":{"slug":"/schema-creation/01-mutations","title":"Mutations"}}},{"node":{"fields":{"slug":"/paging","title":"Paging"}}},{"node":{"fields":{"slug":"/schema-creation","title":"Schema Creation"}}},{"node":{"fields":{"slug":"/introduction","title":"Introduction"}}},{"node":{"fields":{"slug":"/schema-creation/02-fields","title":"Field Arguments"}}},{"node":{"fields":{"slug":"/schema-creation/04-directives","title":"Directives"}}},{"node":{"fields":{"slug":"/schema-creation/05-other-data-sources","title":"Other Data Sources"}}},{"node":{"fields":{"slug":"/schema-creation/03-types","title":"Other Types"}}},{"node":{"fields":{"slug":"/schema-creation/06-naming","title":"Note on Naming"}}}]}},"pageContext":{"id":"04a28633-b666-5a16-aec8-abe520ec6ff5"}},"staticQueryHashes":["2619113677","3706406642","417421954"]}