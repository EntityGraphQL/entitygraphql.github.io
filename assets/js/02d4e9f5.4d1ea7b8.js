"use strict";(self.webpackChunkentity_graphql_docs=self.webpackChunkentity_graphql_docs||[]).push([[121],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>c});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},m=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=p(t),c=i,h=u["".concat(s,".").concat(c)]||u[c]||d[c]||r;return t?a.createElement(h,o(o({ref:n},m),{},{components:t})):a.createElement(h,o({ref:n},m))}));function c(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},2336:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=t(7462),i=(t(7294),t(3905));const r={},o="Serialization & Field Naming",l={unversionedId:"serialization-naming/serialization-naming",id:"serialization-naming/serialization-naming",title:"Serialization & Field Naming",description:"GraphQL is case-sensitive. Currently EntityGraphQL will automatically turn field and argument names from UpperCase to camelCase when you use the helper methods to create a schema with the default options. This means your C# code matches what C# code typically looks like and your GraphQL matches the GraphQL norm too.",source:"@site/docs/serialization-naming/serialization-naming.md",sourceDirName:"serialization-naming",slug:"/serialization-naming/",permalink:"/docs/serialization-naming/",draft:!1,editUrl:"https://github.com/EntityGraphQL/EntityGraphQL/tree/master/docs/docs/serialization-naming/serialization-naming.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Schema Directives",permalink:"/docs/directives/schema-directives"},next:{title:"Using NewtonSoft JSON",permalink:"/docs/serialization-naming/newtonsoft-json"}},s={},p=[{value:"Serializing Inherited Types",id:"serializing-inherited-types",level:2},{value:"Override default naming",id:"override-default-naming",level:2},{value:"Serialization",id:"serialization",level:2},{value:"Full PascalCase example",id:"full-pascalcase-example",level:2}],m={toc:p};function d(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"serialization--field-naming"},"Serialization & Field Naming"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"GraphQL is case-sensitive"),". Currently EntityGraphQL will automatically turn field and argument names from ",(0,i.kt)("inlineCode",{parentName:"p"},"UpperCase")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"camelCase")," when you use the helper methods to create a schema with the default options. This means your C# code matches what C# code typically looks like and your GraphQL matches the GraphQL norm too."),(0,i.kt)("p",null,"Examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A mutation method in C# named ",(0,i.kt)("inlineCode",{parentName:"li"},"AddMovie")," will be ",(0,i.kt)("inlineCode",{parentName:"li"},"addMovie")," in the schema"),(0,i.kt)("li",{parentName:"ul"},"A root field entity named ",(0,i.kt)("inlineCode",{parentName:"li"},"Movie")," will be named ",(0,i.kt)("inlineCode",{parentName:"li"},"movie")," in the schema"),(0,i.kt)("li",{parentName:"ul"},"A mutation arguments class (",(0,i.kt)("inlineCode",{parentName:"li"},"ActorArgs"),") with fields ",(0,i.kt)("inlineCode",{parentName:"li"},"FirstName")," & ",(0,i.kt)("inlineCode",{parentName:"li"},"Id")," will be arguments in the schema as ",(0,i.kt)("inlineCode",{parentName:"li"},"firstName")," & ",(0,i.kt)("inlineCode",{parentName:"li"},"id")),(0,i.kt)("li",{parentName:"ul"},"If you're using the schema builder manually, the names you give will be the names used. E.g. ",(0,i.kt)("inlineCode",{parentName:"li"},'schemaProvider.AddField("someField", ...)')," is different to ",(0,i.kt)("inlineCode",{parentName:"li"},'schemaProvider.AddField("SomeField", ...)'))),(0,i.kt)("h2",{id:"serializing-inherited-types"},"Serializing Inherited Types"),(0,i.kt)("p",null,"In versions prior to .NET 7, System.Text.Json doesn't support the serialization of polymorphic type hierarchies. For example, if a property's type is an interface or an abstract class, only the properties defined on the interface or abstract/union class are serialized, even if the runtime type has additional properties. "),(0,i.kt)("p",null,"For this reason EntityGraphQL registers a RuntimeTypeJsonConverter class as part of the DefaultGraphQLResponseSerializer (credit to litleAndroidMan from ",(0,i.kt)("a",{parentName:"p",href:"https://stackoverflow.com/a/71074354/629083"},"https://stackoverflow.com/a/71074354/629083"),")."),(0,i.kt)("p",null,"If you're overriding the DefaultGraphQLResponseSerializer or using System.Text.Json directly you can still use this class by registering it yourself."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"this.jsonOptions.Converters.Add(new RuntimeTypeJsonConverter<object>());\n")),(0,i.kt)("p",null,"You can also disable it by passing in your own jsonOptions when you register/create DefaultGraphQLResponseSerializer."),(0,i.kt)("h2",{id:"override-default-naming"},"Override default naming"),(0,i.kt)("p",null,"To override the default behaviour you can pass in your own ",(0,i.kt)("inlineCode",{parentName:"p"},"fieldNamer")," function when creating the ",(0,i.kt)("inlineCode",{parentName:"p"},"SchemaProvider")," or configuring it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"services.AddGraphQLSchema<DemoContext>(options => {\n    options.FieldNamer = name => name; // use the dotnet name as is\n});\n")),(0,i.kt)("p",null,"Then make sure you follow your naming policy when adding fields to the schema."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},'services.AddGraphQLSchema<DemoContext>(options => {\n    options.FieldNamer = name => name; // use the dotnet name as is\n    options.ConfigureSchema = schema => {\n        schema.Query().AddField("SomeField", ...)\n    };\n});\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Note that this impacts the names used for fields and arguments in the GraphQL schema and how these are matched to a query. This can impact serialization, but is not serialization.")),(0,i.kt)("p",null,"An example - our ",(0,i.kt)("inlineCode",{parentName:"p"},"DemoContext")," with the default ",(0,i.kt)("inlineCode",{parentName:"p"},"fieldNamer")," will create this GraphQL schema (trimmed down for the example). Note the ",(0,i.kt)("inlineCode",{parentName:"p"},"camelCase")," naming."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql"},"schema {\n    query: Query\n}\n\nType Query {\n    people: [Person]\n    person(id: ID!): Person\n}\n\nType Person {\n    id: ID!\n    firstName: String!\n    ...\n}\n")),(0,i.kt)("p",null,"This means queries need to match the casing as GraphQL is case-sensitive."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql"},"{\n  # will work\n  people {\n    id\n    firstName\n  }\n\n  # will fail\n  People {\n    id\n    firstName\n  }\n}\n")),(0,i.kt)("p",null,"The above query will generate typed objects ",(0,i.kt)("em",{parentName:"p"},"before serialization")," with the matching names from the schema. ",(0,i.kt)("em",{parentName:"p"},"Note the types are generated internally as part of compiling, users do not need to use/know them but it demostrates serialization impact"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"public class TempPersonResult\n{\n    // names taken from schema naming - e.g. camelCase\n    public Guid id;\n    public string firstName;\n}\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"QueryResult")," object is a dictionary of root level queries ",(0,i.kt)("inlineCode",{parentName:"p"},"{ fieldName: object }")," and in the above case it would be"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},'IEnumerable<TempPersonResult> people = ... // implementation is more complex and not shown here - see Entity Framework section for more info\nQueryResult result = ctx => {\n    {"people", people} // key taken from schema file name - camelCase\n}\n')),(0,i.kt)("h2",{id:"serialization"},"Serialization"),(0,i.kt)("p",null,"We see how types/fields are named by default above and how to change that. Next you may want to change how data comming in or returned is deserialized or serialized."),(0,i.kt)("p",null,"You can customise how EntityGraphQL handles de/serialization by registering your own ",(0,i.kt)("inlineCode",{parentName:"p"},"IGraphQLResponseSerializer")," and/or ",(0,i.kt)("inlineCode",{parentName:"p"},"IGraphQLRequestDeserializer"),". Both should be registered before calling ",(0,i.kt)("inlineCode",{parentName:"p"},"AddGraphQLSchema()")," as it adds the default implementations if not already registered."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"IGraphQLRequestDeserializer")," - Used to deserialize an incoming ",(0,i.kt)("inlineCode",{parentName:"li"},"POST")," body data into a ",(0,i.kt)("inlineCode",{parentName:"li"},"QueryRequest")," object"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"IGraphQLResponseSerializer")," - Used to serialize a ",(0,i.kt)("inlineCode",{parentName:"li"},"QueryResult")," object into the ",(0,i.kt)("inlineCode",{parentName:"li"},"Response")," stream")),(0,i.kt)("p",null,"The default implementations try to deserialize JSON into the ",(0,i.kt)("inlineCode",{parentName:"p"},"QueryRequest")," object and serialize the ",(0,i.kt)("inlineCode",{parentName:"p"},"QueryResult")," object to JSON using the following JSON options."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"var jsonOptions = new JsonSerializerOptions\n{\n    // the internal generated types use fields so include this\n    IncludeFields = true,\n    PropertyNamingPolicy = JsonNamingPolicy.CamelCase, // match common JSON style and fits with many GraphQL tools\n};\n// Convert ENUMs to their string names\nvar jsonOptions.Converters.Add(new JsonStringEnumConverter());\n")),(0,i.kt)("p",null,"You can quickly overwrite the default JSON options without implementing your own ",(0,i.kt)("inlineCode",{parentName:"p"},"IGraphQLResponseSerializer")," and/or ",(0,i.kt)("inlineCode",{parentName:"p"},"IGraphQLRequestDeserializer"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"var jsonOptions = new JsonSerializerOptions\n{\n    // the internal generated types use fields so include this\n    IncludeFields = true,\n    // leaving out the camelCase option\n};\n// overwrite the JSON options using the DefaultGraphQLResponseSerializer\nservices.AddSingleton<IGraphQLResponseSerializer>(new DefaultGraphQLResponseSerializer(jsonOptions));\nservices.AddGraphQLSchema<DemoContext>();\n")),(0,i.kt)("h2",{id:"full-pascalcase-example"},"Full PascalCase example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"var jsonOptions = new JsonSerializerOptions\n{\n    // the internal generated types use fields so include this\n    IncludeFields = true,\n};\nvar jsonOptions.Converters.Add(new JsonStringEnumConverter());\nservices.AddSingleton<IGraphQLRequestDeserializer>(new DefaultGraphQLRequestDeserializer(jsonOptions));\nservices.AddSingleton<IGraphQLResponseSerializer>(new DefaultGraphQLResponseSerializer(jsonOptions));\n\nservices.AddGraphQLSchema<DemoContext>(options =>\n{\n    options.FieldNamer = name => name;\n});\n")),(0,i.kt)("p",null,"The above expects a JSON request like"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Query": "query { People { Id FirstName } }"\n}\n')),(0,i.kt)("p",null,"And a JSON result like"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "People": [\n        {\n            "Id": "123",\n            "FirstName": "Bob"\n        },\n        ...\n    ]\n}\n')))}d.isMDXComponent=!0}}]);